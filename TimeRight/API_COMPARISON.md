# 대중교통 API 비교 분석

## 📋 목차
1. [현재 상황 분석](#현재-상황-분석)
2. [API 옵션 비교](#api-옵션-비교)
3. [가격 및 한도 분석](#가격-및-한도-분석)
4. [정확성 및 성능 비교](#정확성-및-성능-비교)
5. [최종 권장사항](#최종-권장사항)

---

## 🔍 현재 상황 분석

### TimeRight의 API 요구사항
```
핵심 기능: 실시간 버스 도착 정보 + 정확한 타이밍 판단
├── 실시간성: 30초 이내 최신 데이터
├── 정확도: 도착 시간 오차 ±1분 이내
├── 커버리지: 서울 → 전국 확장 가능
├── 호출 빈도: 사용자당 5-10초마다 (높음)
└── 비용: 무료 또는 저렴 (MVP 단계)
```

### 현재 계획 (서울시 버스 API)
**장점**:
- ✅ 완전 무료
- ✅ 호출 제한 없음
- ✅ 공식 데이터 (신뢰도 높음)

**단점**:
- ❌ 서울시만 커버
- ❌ 응답 속도 느림 (평균 500-1000ms)
- ❌ 가끔 불안정 (점검, 다운타임)
- ❌ 지하철, 신호등은 별도 API 필요

---

## 🆚 API 옵션 비교

### 1️⃣ 서울시 공공 API (현재 계획)
**제공**: 서울시 버스, 지하철
**URL**: http://ws.bus.go.kr/api/rest

| 항목 | 평가 | 상세 |
|------|------|------|
| **가격** | ⭐⭐⭐⭐⭐ | 완전 무료 |
| **제한** | ⭐⭐⭐⭐⭐ | 무제한 호출 |
| **정확성** | ⭐⭐⭐⭐☆ | 실시간 GPS 기반, 오차 ±1분 |
| **성능** | ⭐⭐⭐☆☆ | 500-1000ms, 가끔 느림 |
| **커버리지** | ⭐⭐☆☆☆ | 서울시만 |
| **안정성** | ⭐⭐⭐☆☆ | 가끔 점검, 다운타임 |
| **문서** | ⭐⭐⭐☆☆ | 기본적, 예제 부족 |

**코스트 분석**:
```
무료
├── 호출 제한: 없음
├── 회원가입: 공공데이터포털 (간단)
└── 승인: 즉시
```

**실제 사용 예측**:
```
DAU 1,000명 기준
├── 1인당 평균 세션: 2회/일 (출근, 퇴근)
├── 세션당 평균 시간: 5분
├── 체크 간격: 5-30초 (거리 기반)
├── 평균 API 호출: 20회/세션
└── 총 호출: 40,000회/일

→ 완전 무료로 감당 가능
```

---

### 2️⃣ ODsay (오디세이) Lab API ⭐ 추천
**제공**: 전국 대중교통 통합 API
**URL**: https://lab.odsay.com/

| 항목 | 평가 | 상세 |
|------|------|------|
| **가격** | ⭐⭐⭐⭐☆ | Free tier 30,000회/일, Pro $99/월 |
| **제한** | ⭐⭐⭐⭐☆ | Free: 30k/일, Pro: 1M/일 |
| **정확성** | ⭐⭐⭐⭐⭐ | 전국 통합 데이터, 매우 정확 |
| **성능** | ⭐⭐⭐⭐⭐ | 200-300ms, 빠름 |
| **커버리지** | ⭐⭐⭐⭐⭐ | **전국** (버스, 지하철, 기차) |
| **안정성** | ⭐⭐⭐⭐⭐ | 매우 안정적, 99.9% uptime |
| **문서** | ⭐⭐⭐⭐⭐ | 매우 상세, SDK 제공 |

**가격 플랜**:
```
Free Tier (MVP 충분)
├── 30,000 호출/일 (= 750명 DAU)
├── 속도 제한: 10 req/s
├── 기능: 실시간 도착 정보, 경로 검색
└── 가격: $0

Pro Plan
├── 1,000,000 호출/일 (= 25,000명 DAU)
├── 속도 제한: 100 req/s
├── 기능: 전체 + 혼잡도, 좌석 정보
└── 가격: $99/월 (~13만원)

Enterprise
├── 무제한
├── 전용 서버, SLA 보장
└── 가격: 협의
```

**실제 사용 예측**:
```
Free Tier로 시작 (MVP)
├── DAU 500명까지: Free Tier 충분
├── DAU 1,000명: Free Tier로 가능 (최적화 필요)
├── DAU 2,000명 이상: Pro Plan 필요
└── 손익분기점: 사용자 1명당 월 65원

결론: Free로 시작, 성장하면 Pro ($99/월)
```

**장점**:
- ✅ 전국 커버 (서울, 경기, 부산, 대구 등)
- ✅ 빠른 응답 속도
- ✅ 통합 API (버스, 지하철, 기차 한 번에)
- ✅ 경로 검색 기능 포함
- ✅ 실시간 혼잡도 정보

**단점**:
- ⚠️ Free tier 제한 (30k/일)
- ⚠️ 유료 전환 필요 (성장 시)

---

### 3️⃣ 카카오모빌리티 API
**제공**: 경로 검색, 대중교통 정보
**URL**: https://developers.kakaomobility.com/

| 항목 | 평가 | 상세 |
|------|------|------|
| **가격** | ⭐⭐⭐☆☆ | Free: 300,000회/일, 이후 종량제 |
| **제한** | ⭐⭐⭐⭐☆ | Free 300k/일, Paid 무제한 |
| **정확성** | ⭐⭐⭐⭐⭐ | 카카오택시 데이터 활용 |
| **성능** | ⭐⭐⭐⭐⭐ | 100-200ms, 매우 빠름 |
| **커버리지** | ⭐⭐⭐⭐⭐ | 전국 (카카오맵 기반) |
| **안정성** | ⭐⭐⭐⭐⭐ | 99.99% uptime |
| **문서** | ⭐⭐⭐⭐⭐ | 완벽한 문서, SDK |

**가격 플랜**:
```
Free Tier
├── 300,000 호출/일 (= 7,500명 DAU)
├── 경로 검색, 도착 정보
└── 가격: $0

Pay-As-You-Go
├── $0.002/호출 (2.6원)
├── 월 사용량에 따라 자동 과금
└── 예: 100만 호출 = $2,000 (260만원)

Enterprise
├── 대량 할인
└── 협의
```

**실제 사용 예측**:
```
Free Tier로 시작
├── DAU 5,000명까지: Free Tier 충분
├── DAU 10,000명: $1,600/월 (208만원)
└── DAU 50,000명: $10,000/월 (1,300만원)

→ 초기 무료, 성장 시 비용 급증
```

**장점**:
- ✅ 넉넉한 Free tier (300k/일)
- ✅ 카카오 생태계 통합 (카카오맵, 카카오내비)
- ✅ 매우 빠른 응답 속도
- ✅ 교통 혼잡도, 실시간 도로 정보

**단점**:
- ❌ 대규모 사용 시 비용 높음
- ⚠️ 종량제 과금 (예측 어려움)

---

### 4️⃣ 네이버 클라우드 지도 API
**제공**: 길찾기, 대중교통 정보
**URL**: https://www.ncloud.com/product/applicationService/maps

| 항목 | 평가 | 상세 |
|------|------|------|
| **가격** | ⭐⭐☆☆☆ | Free: 30,000회/일, 이후 유료 |
| **제한** | ⭐⭐⭐☆☆ | Free 30k/일 |
| **정확성** | ⭐⭐⭐⭐☆ | 네이버 데이터 기반 |
| **성능** | ⭐⭐⭐⭐☆ | 300-400ms |
| **커버리지** | ⭐⭐⭐⭐☆ | 전국 |
| **안정성** | ⭐⭐⭐⭐☆ | 안정적 |
| **문서** | ⭐⭐⭐⭐☆ | 상세 |

**가격 플랜**:
```
Free
├── 30,000 호출/일
└── $0

Standard
├── $0.005/호출 (6.5원)
└── 100만 호출 = $5,000 (650만원)
```

**장점**:
- ✅ 네이버 생태계
- ✅ 안정적

**단점**:
- ❌ Free tier 제한적 (30k/일)
- ❌ 유료 시 비싼 편

---

### 5️⃣ TMAP API
**제공**: 실시간 교통 정보, 경로 검색
**URL**: https://openapi.sk.com/

| 항목 | 평가 | 상세 |
|------|------|------|
| **가격** | ⭐⭐⭐☆☆ | Free tier 제한적, 협의 필요 |
| **제한** | ⭐⭐⭐☆☆ | 용도에 따라 다름 |
| **정확성** | ⭐⭐⭐⭐⭐ | SK 내비게이션 데이터 |
| **성능** | ⭐⭐⭐⭐☆ | 300-500ms |
| **커버리지** | ⭐⭐⭐⭐⭐ | 전국 + 실시간 도로 |
| **안정성** | ⭐⭐⭐⭐☆ | 안정적 |
| **문서** | ⭐⭐⭐☆☆ | 보통 |

**장점**:
- ✅ SK 내비게이션 데이터
- ✅ 실시간 도로 정보 우수

**단점**:
- ⚠️ 가격 정책 불투명
- ⚠️ 승인 절차 복잡

---

## 💰 가격 및 한도 분석

### 시나리오: DAU별 월 비용 예측

| DAU | 일 호출 수 | 서울시 API | ODsay | 카카오모빌리티 | 네이버 |
|-----|-----------|-----------|-------|---------------|--------|
| **500** | 20,000 | **무료** | **무료** | 무료 | 무료 |
| **1,000** | 40,000 | **무료** | $99 | 무료 | $130 |
| **5,000** | 200,000 | **무료** | $99 | 무료 | $1,100 |
| **10,000** | 400,000 | **무료** | $99 | $260 | $2,400 |
| **50,000** | 2,000,000 | **무료** | $299 | $5,200 | $12,700 |
| **100,000** | 4,000,000 | **무료** | 협의 | $10,400 | $25,900 |

### 손익분기점 분석

**ODsay Pro ($99/월) 기준**:
```
월 $99 = 약 13만원
사용자 1명당 비용 = $0.099/월 (약 130원)

수익 모델:
├── 광고 수익: 사용자당 월 $0.50 (650원)
├── 프리미엄: 월 $2.99 (3,900원)
└── 손익분기점: 260명 (광고), 44명 (프리미엄)

결론: 충분히 수익성 있음
```

**카카오모빌리티 ($0.002/호출) 기준**:
```
10,000 DAU = 월 400,000 호출
월 비용 = $800 (104만원)
사용자당 = $0.08/월 (104원)

손익분기점: 210명 (광고), 35명 (프리미엄)
```

---

## 🎯 정확성 및 성능 비교

### 실시간성 테스트 (예상)

| API | 응답 속도 | 업데이트 주기 | 오차 범위 |
|-----|----------|-------------|----------|
| 서울시 API | 500-1000ms | 30-60초 | ±1-2분 |
| ODsay | 200-300ms | 20-30초 | ±30초-1분 |
| 카카오모빌리티 | 100-200ms | 15-20초 | ±30초 |
| 네이버 | 300-400ms | 30초 | ±1분 |
| TMAP | 300-500ms | 20-30초 | ±30초 |

### TimeRight 요구사항 충족도

```
요구사항: 5-10초마다 체크, ±1분 오차 허용

✅ 서울시 API: 충족 (단, 서울만)
✅ ODsay: 충족
✅ 카카오모빌리티: 충족
✅ 네이버: 충족
✅ TMAP: 충족

→ 모두 기술적으로 충족, 차이는 커버리지와 비용
```

---

## 🏆 최종 권장사항

### 전략: 하이브리드 접근

```
Phase 1: MVP (DAU < 500)
├── 주 API: 서울시 공공 API (무료)
├── 보조 API: ODsay Free (전국 확장용)
├── 비용: $0
└── 기간: 3-6개월

Phase 2: 초기 성장 (DAU 500-2,000)
├── 주 API: ODsay Pro ($99/월)
├── 보조 API: 서울시 API (서울 특화)
├── 비용: $99/월 (13만원)
└── 기간: 6-12개월

Phase 3: 스케일업 (DAU 2,000-10,000)
├── 주 API: 카카오모빌리티 (넉넉한 Free tier)
├── 보조 API: ODsay (백업)
├── 비용: $0-500/월
└── 기간: 12-24개월

Phase 4: 대규모 (DAU 10,000+)
├── 주 API: 카카오모빌리티 or Enterprise 계약
├── 자체 데이터 수집: 크라우드소싱
├── 비용: $500-2,000/월 (협상)
└── 기간: 24개월+
```

### 구현 전략: Multi-API Architecture

```typescript
// services/TransportAPIManager.ts
class TransportAPIManager {
  private primaryAPI: 'seoul' | 'odsay' | 'kakao';
  private fallbackAPIs: Array<API>;

  async getArrivalInfo(stopId: string, region: string) {
    // 1. 지역별 최적 API 선택
    const api = this.selectOptimalAPI(region);

    try {
      return await api.getArrival(stopId);
    } catch (error) {
      // 2. Fallback to 다른 API
      return await this.fallbackAPIs[0].getArrival(stopId);
    }
  }

  private selectOptimalAPI(region: string) {
    if (region === 'seoul') {
      // 서울: 무료 API 우선
      return new SeoulBusAPI();
    } else {
      // 전국: ODsay or 카카오
      return new ODsayAPI();
    }
  }
}
```

---

## 📊 비용 최적화 전략

### 1. 캐싱 전략
```
현재: 30초 캐시
개선:
├── 거리 > 1km: 2분 캐시 (API 호출 75% 감소)
├── 거리 500m-1km: 1분 캐시 (50% 감소)
├── 거리 < 500m: 30초 캐시
└── 예상 절감: API 호출 60% 감소
```

### 2. 스마트 폴링
```
현재: 5-30초 간격
개선:
├── 버스 도착 > 10분: 60초 간격
├── 버스 도착 5-10분: 30초 간격
├── 버스 도착 2-5분: 10초 간격
├── 버스 도착 < 2분: 5초 간격
└── 예상 절감: API 호출 40% 감소
```

### 3. 크라우드소싱
```
사용자 위치 + 버스 도착 시간 수집
├── 10,000명 사용자 = 10,000개 데이터포인트/일
├── 머신러닝으로 도착 시간 예측
├── API 호출 없이도 80% 정확도 가능
└── Phase 4 이후 자체 데이터로 전환
```

---

## ✅ 액션 아이템

### 즉시 (MVP)
- [ ] 서울시 공공 API 키 발급
- [ ] ODsay Free tier 가입
- [ ] Multi-API Manager 구현
- [ ] 지역별 API 자동 선택 로직

### 1개월 내
- [ ] 캐싱 최적화 구현
- [ ] 스마트 폴링 알고리즘 구현
- [ ] API 사용량 모니터링 대시보드

### 3개월 내
- [ ] 크라우드소싱 데이터 수집 시작
- [ ] 머신러닝 예측 모델 프로토타입

### 6개월 내
- [ ] ODsay Pro 전환 평가
- [ ] 자체 예측 모델 정확도 80% 달성
- [ ] API 비용 50% 절감

---

## 📌 결론

**추천 조합**:
```
✅ 서울: 서울시 공공 API (무료, 무제한)
✅ 전국: ODsay (Free → Pro, 정확도 최고)
✅ 백업: 카카오모빌리티 (안정성)

예상 비용:
├── 0-6개월: $0 (완전 무료)
├── 6-12개월: $99/월 (ODsay Pro)
├── 12-24개월: $99-500/월
└── 24개월+: 자체 데이터로 전환

ROI: 매우 높음 (사용자당 비용 < $0.1/월)
```

이 전략으로 **무료로 시작해서 점진적으로 확장**할 수 있습니다!
